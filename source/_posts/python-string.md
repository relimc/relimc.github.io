---
title: Python 基础：字符串
categories:
  - Python
tags:
  - 二进制
  - 字符串
  - 字符集
  - 字符编码
  - 数据类型
comments: true
date: 2020-05-19 08:49:39
---

## 回顾相关知识

在学习字符串之前，我们得要回顾一下计算机相关的知识。

### 0/1

> 鸟哥. 鸟哥的 Linux 私房菜 基础学习篇（第三版）第0章 0. 1. 6 计算机上面常用的计算单位（大小、速度等）

计算机依据有没有通电来记录信息，所以理论上它只认识 0 与 1 而已。0/1 的单位我们称为 bit。但 bit 实在太小了，并且在存储数据时每份简单的数据都会使用到 8 个 bit 的大小来记录，因此定义出 Byte 这个单位，它们的关系为：

1Byte = 8bit

不过同样地，Byte 还是太小了，在较大的容量情况下，使用 Byte 相当不容易判断数据的大小，举例来说，1000000B 这样的显示方式你能够看得出有几个零吗？所以后来就有一些常见的简化单位表示法，例如 K 代表1024，M 代表 1024K 等。而这些单位在不同的进位制下有不同的数值表示，下面就列出常见的单位与进位制对应表，如表0-1所示。

| 进位制 |  K   |   M   |   G   |   T   |   P   |
| :----: | :--: | :---: | :---: | :---: | :---: |
| 二进制 | 1024 | 1024K | 1024M | 1024G | 1024T |
| 十进制 | 1000 | 1000K | 1000M | 1000G | 1000G |

一般来说，文件大小使用的是二进制的方式，所以 1GB 的文件大小实际上为：1024x1024x1024B 这么大。速度单位则常使用十进制，例如 1GHz 就是 1000x1000x1000Hz 的意思。

> 鸟哥. 鸟哥的 Linux 私房菜 基础学习篇（第三版）第0章 0. 1. 6 计算机上面常用的计算单位（大小、速度等）

<!-- more -->

### 编译型语言和解释型语言

如果计算机认识 0 和 1，那么人类能够识别的编程语言是如何被计算机认识的呢？这就涉及到另外的一块知识了。

> 以下解释来自博文[编译型语言和解释型语言的简单介绍](https://www.cnblogs.com/chiweiming/p/11826787.html)

#### 编译型语言

编译型语言是指使用专门的编译器，针对特定平台（操作系统）将某种高级语言源代码一次性“翻译”成可被该平台硬件执行的机器码（包括机器指令和操作数），并包装成该平台所能识别的可执行性程序的格式，这个转换过程称为“编译”。编译生成的可执行性程序可以脱离开发环境，在特定的平台上独立运行。

因为编译型语言是一次性地编译成机器码，所以可以脱离开发环境独立运行，而且通过运行效率较高；但因为编译型语言的程序被编译成特定平台上的机器码，因为编译生成的可执行性程序通常无法移植到其他平台上运行；如果需要移植，则必须将源代码复制到特定平台上，针对特定平台进行修改，至少也需要采用特定平台上的编译器重新编译。

#### 解释型语言

解释性语言是指使用专门的解释器对源程序逐行解释成特定平台的机器码并立即执行的语言。解释性语言通常不会进行整体性的编译和链接处理，解释型语言相当于把编译型语言中的编译和解释过程混合到一起同时完成。

可以认为：每次执行解释型语言的程序都需要进行一次编译，因此解释型语言的程序运行效率通常较低，而且不能脱离解释器独立运行。但解释型语言有一个优势：跨平台比较容易，只需提供特定平台的解释器即可，每个特定平台上的解释器负责将源程序解释成特定平台的机器指令即可。解释型语言可以方便地实现源程序级的移植，但这是以牺牲程序执行效率为代价的。

个人总结：编译型语言一次性将源码进行编译完成并生成可执行性程序（比如.exe程序）；解释型语言逐行进行编译并且解释执行（比如解释JavaScript源码从上往下逐条解释执行）。

### 字符集与字符编码

> 以下解释来自博文[[字符集和字符编码的区别](https://www.cnblogs.com/xdyixia/p/9114145.html)]

**字符：**在计算机和电信技术中，一个字符是一个单位的字形、类字形单位或符号的基本信息。即一个字符可以是一个中文汉字、一个英文字母、一个阿拉伯数字、一个标点符号等。

**字符集：**多个字符的集合。例如GB2312是中国国家标准的简体中文字符集，GB2312收录简化汉字（6763个）及一般符号、序号、数字、拉丁字母、日文假名、希腊字母、俄文字母、汉语拼音符号、汉语注音字母，共 7445 个图形字符。

**字符编码：**把字符集中的字符编码为（映射）指定集合中的某一对象（例如：比特模式、自然数序列、电脉冲），以便文本在计算机中存储和通过通信网络的传递。

**字符集和字符编码的关系：**字符集是书写系统字母与符号的集合，而字符编码则是将字符映射为一特定的字节或字节序列，是一种规则。通常特定的字符集采用特定的编码方式（即一种字符集对应一种字符编码（例如：ASCII、IOS-8859-1、GB2312、GBK，都是即表示了字符集又表示了对应的字符编码，但Unicode不是，它采用现代的模型）），因此基本上可以将两者视为同义词。

> 以上解释来自博文[[字符集和字符编码的区别](https://www.cnblogs.com/xdyixia/p/9114145.html)]

再推荐两篇相关的博文：

+ [廖雪峰.字符串和编码](https://www.liaoxuefeng.com/wiki/1016959663602400/1017075323632896)
+ [阮一峰.字符编码笔记：ASCII，Unicode 和 UTF-8](http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html)

## 开始学习字符串

前文提到了字符的概念。了解了字符是什么，字符串也就好理解了。**字符串就是多个字符的有序集合。**在 Python 中没有字符类型，只有字符串类型，因此像`a`这样的单个字符在 Python 中被认为是一个字符串。在Python3中，所有的字符串都是Unicode字符串。这意味着 Python 中的字符串不仅可以是英文序列，还可以是中文、日文等不在 ASCII 编码范围的字符。

### 定义字符串

字符串是 Python 内置的数据类型，可由单引号、双引号和三引号来定义。

```python
str1 = 'hello world!'
str2 = "hello world!"
str3 = '''Hello world!'''
```

在定义字符串时，双引号和单引号完全等价。只需注意，用双引号定义包含单引号的字符串，用单引号定义包含双引号的字符串。

```python
single_quotes_str = "我是包含'的字符串" # 单引号是字符串的一部分
double_quotes_str = '我是包含"的字符串' # 双引号是字符串的一部分
```

Python三引号允许一个字符串跨多行，字符串中可以包含换行符、制表符以及其他特殊字符。

```python
para_str = """这是一个多行字符串的实例
多行字符串可以使用制表符
TAB ( \t )。
也可以使用换行符 [ \n ]。
"""
print (para_str)
```

### 查看字符串

先定义一个用例字符串。

```python
string = 'hello world!'
```

**返回字符串长度**

```python
len(string) # 12
```

**通过索引查看某个字符串**

```python
string[0] # h 第一个字符
string[-1] # ! 最后一个字符
string[12] # 索引的最大值为11，报错信息：IndexError: string index out of range
```

**查看某个字符串在字符串中出现的次数**

```python
string.count('l') # 3
```

**查看字符串是否以某个字符串开头**

```python
string.startswith("h") # True
```

**查看字符串是否以某个字符串结尾**

```python
string.endswith("!") # True
```

**查看某个字符串是否包含在字符串中**

```python
# 返回开始的索引值，不包含则返回 -1
string.find("world") # 6

# 返回开始的索引值，不包含会报错
string.index("world") # 6
```

**如果字符串至少有一个字符并且所有字符都是字母则返回 True，否则返回 False**

```python
"abc".isalpha() # True
"abc123".isalpha() # False
```

**如果字符串只包含数字则返回 True，否则返回 False**

```python
# True: Unicode 数字，byte 数字（单字节），全角数字（双字节）
"123".isdigit() # True
"abc123".isdigit() # False

# True: Unicode 数字，，全角数字（双字节）
"123".isdecimal() # True
"abc123".isdecimal() # False

# True: Unicode 数字，全角数字（双字节），汉字数字
"123".isnumeric() # True
"abc123".isnumeric() # False
"一二三".isnumeric() # True
```

**如果字符串至少有一个字符并且所有字符都是字母或数字则返回 True，否则返回 False**

```python
"abc123".isalnum() # True
"abc'123".isalnum() # False
```

**如果字符串中包含至少一个区分大小写的字符，并且所有这些(区分大小写的)字符都是小写，则返回 True，否则返回 False**

```python
print("aBCD".islower()) # False
print("Abcd".islower()) # False
print("abcd".islower()) # True
print("abc123".islower()) # True
```

**如果字符串中包含至少一个区分大小写的字符，并且所有这些(区分大小写的)字符都是大写，则返回 True，否则返回 False**

```python
print("aBCD".isupper()) # False
print("Abcd".isupper()) # False
print("ABCD".isupper()) # False
print("ABC123".isupper()) # True
```

**如果字符串中只包含空白，则返回 True，否则返回 False**

```python
print("".isspace()) # False
print("   ".isspace()) # True
```

### 修改字符串

前文不是说，字符串是不可变对象吗？现在怎么又能够修改字符串了？

我们来看一个例子。

```python
a = "hello world!"
print(a.replace("world", "china")) # hello china!
print(a) # hello world!
```

在第二行代码中，我们通过 `hello world!` 获得了 `hello china!` 字符串。貌似修改了字符串，其实看到第三行代码后，我们就知道 `a` 还是 `hello world!`，并没有被修改。那第二行的 `hello china` 是什么情况。我们来改写上面的代码。

```python
a = "hello world!"
b = a.replace("world", "china")
print(b) # hello china!
print(a) # hello world!
print(id(b) == id(a)) # False
```

字符串提供的 replace 方法并没有直接对 `hello world!` 对象做修改，而是以该对象为蓝本，通过 replace 参数提供的信息，生成了一个新的对象 `hello china!`。通过 id 方法也验证了它们在内存中是不同的对象，而不是同一个对象的内容发生了改变。

也就是说，这里的修改字符串，是指以原字符串为蓝本，生成新的符合需求的字符串。

#### 大小写转换

**将字符串的第一个字符转换为大写**

```python
"apple".capitalize() # Apple
```

**转换字符串中的小写字母为大写**

```python
"apple".upper() # APPLE
```

**转换字符串中所有大写字符为小写**

```python
"Apple".lower() # apple
"APPLE".lower() # apple
```

**将字符串中大写转换为小写，小写转换为大写**

```python
"Apple".swapcase() # aPPLE
```

#### 处理空格

**截掉字符串左边的空格或指定字符**

```python
"   apple".lstrip() # apple
```

**删除字符串字符串末尾的空格**

```python
"apple   ".rstrip() # apple
```

**在字符串上执行 lstrip() 和 rstrip()**

```python
"   apple   ".strip() # apple
```

#### 替换字符串

字符串提供了一个 replace 方法用来替换字符串。

> replace(old, new [, max\])
>
> 把 将字符串中的 old 替换成 new,如果 max 指定，则替换不超过 max 次。

```python
# 把 world 换成 china
string = "hello world!"
print(string.replace("world", "china")) # hello china!
```

#### 切割字符串

字符串提供了一个 split 方法用来切割字符串，返回值是一个列表。

> split(str="", num=string.count(str))
>
> 以 str 为分隔符截取字符串，如果 num 有指定值，则仅截取 num+1 个子字符串

```python
# 以空格为分隔符，切割字符串
string = "hello world!" 
print(string.split(" ")) # ['hello', 'world!']
```

字符串的切割还可以通过切片技术来实现。可移步[Python 基础：切片](https://relimc.github.io/blog/2020/05/18/python-slice/)。

#### 拼接字符串

字符串提供了一个 join 方法来拼接字符串，其参数是一个序列。

> join(seq)
>
> 以指定字符串作为分隔符，将 seq 中所有的元素(的字符串表示)合并为一个新的字符串

```python
"".join(["a", "p", "p", "l", "e"]) # apple
```

我们也可以使用操作符 **+** 来拼接字符串。

```python
a = "hello "
b = "world"
print(a + b) # hello world
```

### 格式化字符串

#### 使用 **%** 格式化字符串

```python
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
格式化字符串
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
# %s 表示此处是字符串占位符，% 后需要一个字符串变量来给占位符提供值
name = "Lee"
print("My name is %s." % name) # My name is Lee.
```

在格式化字符串时，在 **%整数s** 语法下，出现了字符串长度和占位符长度这两种长度值，打印出来的字符串长度总是等于其中较大的长度。当字符串长度大于占位符长度时，完整显示字符串；当字符串长度小于占位符长度时，字符串长度需要先补长至占位符长度，以 **空格** 作为补长符，差几个就在字符串左侧补几个空格。

```python
# %2s 表示占位符长度为2，当字符串长度大于占位符长度 2 时，按完整长度打印变量
name = "Lee"
print("My name is %2s." % name) # My name is Lee.

# %4s 表示占位符长度为4，此时字符串长度为3，需要在字符串左侧添加 （4-3） 个空格
name = "Lee"
print("My name is %4s." % name) # My name is  Lee.
```

在格式化字符串时，在 **%小数s** 语法下，出现了字符串长度和占位符长度这两种长度值，打印出来的字符串长度总是等于其中较小的长度。当字符串长度大于占位符长度时，字符串将会被截取为片段；当字符串长度小于占位符长度时，完整显示字符串。

```python
# %.2s 表示占位符长度为2，当字符串长度大于占位符长度 2 时，字符串将被截取为前 2 个字符
name = "Lee"
print("My name is %.2s." % name) # My name is Le.

# %.4s 表示占位符长度为4，当字符串长度小于占位符长度 4 时，字符串将会完整打印
name = "Lee"
print("My name is %.4s." % name) # My name is Lee.
```

#### 使用 **%** 格式化整数

```python
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
格式化整数
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
# %d 表示此处是整数占位符，% 后需要一个整数变量来给占位符提供值
age = 18
print("I am %d years old." % age)
```

在格式化整数时，在 **%整数d** 语法下，出现了整数位数和占位符位数这两种位数值，打印出来的整数位数总是等于其中较大的位数。当整数位数大于占位符位数时，完整显示整数；当整数位数小于占位符位数时，整数位数需要先补长至占位符位数，以 **空格** 作为补长符，差几个就在整数左侧补几个空格。

```python
# %1d 表示占位符位数为1，当整数位数大于占位符位数 1 时，按完整位数打印变量
age = 18
print("I am %1d years old." % age) # I am 18 years old.

# %3d 表示占位符位数为3，此时整数位数为2，需要在整数左侧添加 （3-2） 个空格
age = 18
print("I am %3d years old." % age) # I am  18 years old.

# 对于数字来说，我们更希望补长符为0，于是就有这种写法：
age = 18
print("I am %03d years old." % age) # I am 018 years old.

# 或者
age = 18
print("I am %.3d years old." % age) # I am 018 years old.
```

#### 使用 **%** 格式化小数

```python
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
格式化小数
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
# %f 表示此处是小数占位符，% 后需要一个小数变量来给占位符提供值
# %f 默认小数点后6位数
pi = 3.14
print("π = %f" % pi) # π = 3.140000
```

可以指定小数点位数

```python
pi = 3.14
print("π = %.2f" % pi) # π = 3.14
```

可以只保留整数

```python
pi = 3.14
print("π = %.f" % pi) # π = 3
```

#### 使用 % 格式化多种数据

```python
# 多个变量放在同一个括号里面，变量之间用逗号分隔
name = 'Lee'
age = 18
print("%s is %d years old." % (name, age)) # Lee is 18 years old.
print("%s is %d years old." % ('Lee', 18)) # Lee is 18 years old.
```

#### 使用 format 格式化字符串

Python2.6 开始，新增了一种格式化字符串的函数 **str.format()**，它增强了字符串格式化的功能。

基本语法是通过 **{}** 来代替以前的 **%** 。format 函数可以接受不限个参数，位置可以不按顺序。

```python
# 不指定位置
print("{} {}".format("hello", "world!")) # hello world!

# 指定位置
print("{0} {1}".format("hello", "world!")) # hello world!
print("{1} {0}".format("world!", "hello")) # hello world!
```

从源码中可以发现，format 函数可以接收可变参数和关键字参数。

```python
def format(self, *args, **kwargs): # known special case of str.format
```

前面的例子中，使用的是可变参数，我们同样可以使用关键字参数。

```python
# Lee is 18 years old.
"{name} is {age} years old.".format(name = "Lee", age = 18)
```

##### 格式化字符串的specification（规范）

前文的 format 写法是最基本的用法，只是将占位符替换为对应的值，并没有起到格式化字符串的目的。在格式化字符串时常常使用的是带冒号的用法：

``` python
for i in range(1, 10):
    for j in range(1, i+1):
        if j == i:
            print("{0} * {1} = {2:02d}".format(i, j, i * j))
        else:
            print("{0} * {1} = {2:02d}".format(i, j, i * j), end=' ')
```

这是一个打印出99乘法表的代码，我们注意到 `{2:02d}` 与 `{0}` 和 `{1}` 是不一样的，冒号后的 `02d` 是一种字符串规范。其完整格式如下：

> [[fill] align][sign][#][0][width][,][.precision][type]


| 规范  | 含义                                                         |
| ----- | ------------------------------------------------------------ |
| fill  | 对齐后空白处填充字符                                         |
| align | 对齐方式（配合width使用）<左对齐 >右对齐(默认) ＝右对齐(只对数字类型有效) ^居中 |
| sign  | 有无符号数字 可选值 +、-、空格（正号空格，负号加负）         |
# | 对于二进制、八进制、十六进制，如果加上#，会显示 0b/0o/0x，否则不显示
，| 为数字添加分隔符，如：1,000,000
width | 格式化所占宽度（包含字符串本身长度）
.precision | 小数点后保留的位数（会四舍五入）
type | 可选 空默认None 同s



这里的 `02d` 表示两位数的整数，当数字小于10时，前面用 0 来填充，如 4 打印出来就变成了04。

下面逐个解释该规范的用法

###### fill 填充

``` python 
print('{0:04d}'.format(123))  # 0123 四位整数，123 是三位数，前面用 0 填充

# 14 位整数，注意这里的 1 不是用于填充的
print('{0:14d}'.format(123))  # "           123"

# 14 位字符串
print('{0:14}'.format('123'))  # "123           "
```

###### align 对齐

``` python 
print('{0:^14}'.format('123'))   # "     123      " 居中对齐
print('{0:<14}'.format('123'))   # "123           " 居左对齐
print('{0:>14}'.format('123'))   # "           123" 居右对齐
print('{0:a>14}'.format('123'))  # "aaaaaaaaaaa123" 居右对齐用 a 填充
print('{0:1>14}'.format(123))    # "11111111111123" 居右对齐用 1 填充
print('{0:1>14d}'.format(123))   # "11111111111123" 居右对齐用 1 填充
```

##### 重写 __format__ 方法格式化字符串


#### 使用 f-string 格式化字符串

f-string 是 python3.6 之后版本添加的，称之为字面量格式化字符串，是新的格式化字符串的语法。

f-string 格式化字符串以 f 开头，后面跟着字符串，字符串中的表达式用大括号 {} 包起来，它会将变量或表达式计算后的值替换进去。

```python
name = "Lee"
age = 18
# 花括号内是变量
print(f"{name} is {age} years old.") # Lee is 18 years old.
# 花括号内是表达式
print(f"{name} is {13+5} years old.") # Lee is 18 years old.
```
